const e={name:"windy-plugin-heat-units",version:"1.0.8",icon:"üå°Ô∏è",title:"Agricultural Heat Units",description:"Calculate and visualize Growing Degree Days (GDD) for optimal crop management and agricultural planning",author:"crop-crusaders",repository:"https://github.com/crop-crusaders/windy-plugin-heat-units",desktopUI:"rhpane",mobileUI:"fullscreen",routerPath:"/heat-units",addToContextmenu:!0,listenToSingleclick:!0,built:Date.now(),builtReadable:(new Date).toISOString()},t=async e=>{const{el:t}=e,n=function(e,t){if(t instanceof HTMLElement)return t;const n=document.createElement("section");n.className="windy-plugin-heat-units-root",n.style.minHeight="220px",n.style.padding="16px",n.style.background="rgba(255, 255, 255, 0.95)",n.style.color="#2c3e50";const a=function(e){const t="node"in e&&e.node instanceof HTMLElement?e.node:"root"in e&&e.root instanceof HTMLElement?e.root:null;return t??document.body}(e);return a.appendChild(n),n}(e,t);n.innerHTML="",n.dataset.pluginReady="true";const a=(await Promise.resolve().then(function(){return ue})).default;let o=null;try{o=new a({target:n,props:{}})}catch(e){return console.error("Failed to mount Windy heat units plugin UI:",e),function(e){const t=document.createElement("div");t.className="windy-plugin-heat-units-error",t.style.padding="16px",t.style.background="rgba(231, 76, 60, 0.12)",t.style.border="1px solid rgba(231, 76, 60, 0.35)",t.style.borderRadius="8px",t.style.color="#c0392b",t.innerHTML='\n    <h3 style="margin: 0 0 8px 0; font-size: 1rem;">Plugin failed to load</h3>\n    <p style="margin: 0; font-size: 0.85rem; line-height: 1.4;">\n      The Agricultural Heat Units interface could not be initialised. Please reload the plugin or check the browser console for details.\n    </p>\n  ',e.appendChild(t)}(n),()=>{n.removeAttribute("data-plugin-ready")}}return()=>{o&&(o.$destroy(),o=null),n.removeAttribute("data-plugin-ready"),!t&&n.parentElement&&n.parentElement.removeChild(n)}};function n(){}function a(e){return e()}function o(){return Object.create(null)}function s(e){e.forEach(a)}function r(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(e,t){e.appendChild(t)}function c(e,t,n){const a=function(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;if(t&&t.host)return t;return e.ownerDocument}(e);if(!a.getElementById(t)){const e=y("style");e.id=t,e.textContent=n,function(e,t){i(e.head||e,t),t.sheet}(a,e)}}function d(e,t,n){e.insertBefore(t,n||null)}function p(e){e.parentNode&&e.parentNode.removeChild(e)}function u(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function y(e){return document.createElement(e)}function m(e){return document.createTextNode(e)}function h(){return m(" ")}function v(e,t,n,a){return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n,a)}function g(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function f(e){return""===e?null:+e}function x(e,t){t=""+t,e.data!==t&&(e.data=t)}function b(e,t){e.value=null==t?"":t}function k(e,t,n,a){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function M(e,t,n){for(let n=0;n<e.options.length;n+=1){const a=e.options[n];if(a.__value===t)return void(a.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}function w(e){const t=e.querySelector(":checked");return t&&t.__value}function _(e,t,n){e.classList.toggle(t,!!n)}let T;function $(e){T=e}function D(){if(!T)throw new Error("Function called outside component initialization");return T}const C=[],R=[];let I=[];const G=[],F=Promise.resolve();let S=!1;function L(e){I.push(e)}const P=new Set;let H=0;function z(){if(0!==H)return;const e=T;do{try{for(;H<C.length;){const e=C[H];H++,$(e),E(e.$$)}}catch(e){throw C.length=0,H=0,e}for($(null),C.length=0,H=0;R.length;)R.pop()();for(let e=0;e<I.length;e+=1){const t=I[e];P.has(t)||(P.add(t),t())}I.length=0}while(C.length);for(;G.length;)G.pop()();S=!1,P.clear(),$(e)}function E(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(L)}}const A=new Set;function O(e){return void 0!==e?.length?e:Array.from(e)}function N(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];I.forEach(a=>-1===e.indexOf(a)?t.push(a):n.push(a)),n.forEach(e=>e()),I=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function q(e,t){-1===e.$$.dirty[0]&&(C.push(e),S||(S=!0,F.then(z)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function U(e,t,l,i,c,d,u=null,y=[-1]){const m=T;$(e);const h=e.$$={fragment:null,ctx:[],props:d,update:n,not_equal:c,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:o(),dirty:y,skip_bound:!1,root:t.target||m.$$.root};u&&u(h.root);let v=!1;if(h.ctx=l?l(e,t.props||{},(t,n,...a)=>{const o=a.length?a[0]:n;return h.ctx&&c(h.ctx[t],h.ctx[t]=o)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](o),v&&q(e,t)),n}):[],h.update(),v=!0,s(h.before_update),h.fragment=!!i&&i(h.ctx),t.target){if(t.hydrate){const e=function(e){return Array.from(e.childNodes)}(t.target);h.fragment&&h.fragment.l(e),e.forEach(p)}else h.fragment&&h.fragment.c();t.intro&&((g=e.$$.fragment)&&g.i&&(A.delete(g),g.i(f))),function(e,t,n){const{fragment:o,after_update:l}=e.$$;o&&o.m(t,n),L(()=>{const t=e.$$.on_mount.map(a).filter(r);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]}),l.forEach(L)}(e,t.target,t.anchor),z()}var g,f;$(m)}class W{$$=void 0;$$set=void 0;$destroy(){N(this,1),this.$destroy=n}$on(e,t){if(!r(t))return n;const a=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return a.push(t),()=>{const e=a.indexOf(t);-1!==e&&a.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const j={corn:{name:"Corn",baseTemp:10,upperTemp:30,gddRequired:1200,icon:"üåΩ"},wheat:{name:"Wheat",baseTemp:4,upperTemp:25,gddRequired:1400,icon:"üåæ"},soybean:{name:"Soybean",baseTemp:10,upperTemp:30,gddRequired:1300,icon:"ü´ò"},rice:{name:"Rice",baseTemp:12,upperTemp:35,gddRequired:1800,icon:"üåæ"},cotton:{name:"Cotton",baseTemp:15.5,upperTemp:32,gddRequired:1600,icon:"üåø"},tomato:{name:"Tomato",baseTemp:10,upperTemp:30,gddRequired:1100,icon:"üçÖ"},potato:{name:"Potato",baseTemp:7,upperTemp:30,gddRequired:1e3,icon:"ü•î"},canola:{name:"Canola",baseTemp:5,upperTemp:27,gddRequired:1400,icon:"üåª"}};class B{static calculateSimpleGDD(e,t,n,a){const o=a?Math.min(t,a):t,s=(Math.max(e,n)+o)/2;return Math.max(0,s-n)}static calculateModifiedGDD(e,t,n,a){const o=Math.max(e,n),s=a?Math.min(t,a):t;if(s<n)return 0;const r=(o+s)/2;return Math.max(0,r-n)}static calculateDoubleSineGDD(e,t,n,a){const o=Math.max(e,n),s=a?Math.min(t,a):t;if(s<=n)return 0;const r=(o+s)/2;return Math.max(0,r-n)}static calculateAccumulatedGDD(e,t){const n=[];let a=0;for(const o of e){let e=0;switch(t.method){case"simple":e=this.calculateSimpleGDD(o.tMin,o.tMax,t.baseTemp,t.upperTemp);break;case"modified":e=this.calculateModifiedGDD(o.tMin,o.tMax,t.baseTemp,t.upperTemp);break;case"double-sine":e=this.calculateDoubleSineGDD(o.tMin,o.tMax,t.baseTemp,t.upperTemp)}a+=e,n.push(a)}return n}static getCropStage(e,t){const n=e/t*100;return n<10?"Planting/Emergence":n<25?"Early Vegetative":n<50?"Late Vegetative":n<75?"Reproductive":n<90?"Grain Filling":n<100?"Maturity":"Harvest Ready"}static estimateDaysToMaturity(e,t,n){return e>=t?0:n<=0?1/0:Math.ceil((t-e)/n)}}class V{static async getTemperatureData(e,t,n=30){try{const a=window.W?.picker;if(!a)throw new Error("Windy picker not available");a.getPickerData();const o=this.generateMockTemperatureData(e,t,n);return{lat:e,lon:t,gdd:o.totalGDD,dailyGdd:o.dailyGDD,temperature:{min:Math.min(...o.minTemps),max:Math.max(...o.maxTemps),avg:o.avgTemp}}}catch(e){throw console.error("Error fetching temperature data:",e),e}}static generateMockTemperatureData(e,t,n){const a=new Date,o=[],s=[],r=[];let l=0;const i=10*Math.sin(((new Date).getMonth()-3)*Math.PI/6),c=.5*(50-Math.abs(e));for(let e=n;e>=0;e--){const t=new Date(a);t.setDate(t.getDate()-e),t.getDay();const n=15+i+c+8*(Math.random()-.5),d=8+4*Math.random(),p=n-d/2,u=n+d/2;s.push(p),r.push(u);const y=Math.max(0,(p+u)/2-10);o.push(y),l+=y}return{dailyGDD:o,totalGDD:l,minTemps:s,maxTemps:r,avgTemp:(s.reduce((e,t)=>e+t,0)+r.reduce((e,t)=>e+t,0))/(s.length+r.length)}}static generateHeatMapData(e,t){return Promise.resolve({bounds:e,data:this.generateMockGridData(e,t)})}static generateMockGridData(e,t){const n=[],a=(e.north-e.south)/20,o=(e.east-e.west)/20;for(let t=0;t<20;t++)for(let s=0;s<20;s++){const r=e.south+t*a,l=e.west+s*o,i=Math.sin(((new Date).getMonth()-3)*Math.PI/6),c=.02*(50-Math.abs(r)),d=.3*Math.random(),p=Math.max(0,300+200*i+100*c+100*d);n.push({lat:r,lon:l,gdd:p,intensity:Math.min(1,p/800)})}return n}static async getTornadoRiskData(e,t,n=48){try{const a=this.computeTornadoParameters(e,t),o=this.calculateRiskIndex(a,n),s=this.calculateProbability(o),r=this.generateTornadoTimeline(e,t,n,a);return{lat:e,lon:t,forecastHours:n,riskIndex:o,probability:s,summary:this.getRiskSummary(o),parameters:a,timeline:r}}catch(e){throw console.error("Error fetching tornado risk data:",e),e}}static async generateTornadoRiskOverlay(e,t=48){return{bounds:e,points:this.generateTornadoRiskGrid(e,t)}}static generateTornadoRiskGrid(e,t){const n=(e.north-e.south)/18,a=(e.east-e.west)/18,o=[];for(let s=0;s<=18;s++)for(let r=0;r<=18;r++){const l=e.south+s*n,i=e.west+r*a,c=this.computeTornadoParameters(l,i),d=2.5*(this.pseudoRandom(l,i,t)-.5),p=this.calculateRiskIndex(c,t,d),u=this.calculateProbability(p);o.push({lat:l,lon:i,riskIndex:p,probability:u})}return o}static computeTornadoParameters(e,t){const n=500+2500*this.pseudoRandom(e,t,1),a=8+45*Math.abs(this.pseudoRandom(e,t,2)),o=60+260*this.pseudoRandom(e,t,3);return{cape:Math.round(n),shear:Math.round(10*a)/10,helicity:Math.round(o)}}static calculateRiskIndex(e,t,n=0){let a=10*(.5*Math.min(1,e.cape/3e3)+.3*Math.min(1,e.shear/40)+.2*Math.min(1,e.helicity/350));return a+=Math.min(2,t/72),a+=n,Math.round(10*Math.max(0,Math.min(10,a)))/10}static calculateProbability(e){const t=Math.min(.98,Math.max(.03,e/10*.92+.04));return Math.round(100*t)/100}static generateTornadoTimeline(e,t,n,a){const o=[];for(let s=0;s<=n;s+=3){const r=1-Math.min(.75,s/(1.6*n)),l=3*(this.pseudoRandom(e+s,t-s,n)-.5),i={cape:a.cape*(.9+.2*this.pseudoRandom(e,t,s)),shear:a.shear*(.85+.25*this.pseudoRandom(e,t,s+1)),helicity:a.helicity*(.88+.3*this.pseudoRandom(e,t,s+2))},c=this.calculateRiskIndex(i,n,l)*r,d=Math.round(10*Math.max(0,Math.min(10,c)))/10,p=this.calculateProbability(d)*r;o.push({hourOffset:s,riskIndex:Math.round(10*d)/10,probability:Math.round(100*Math.max(.02,Math.min(.98,p)))/100})}return o}static getRiskSummary(e){return e<2?"Minimal tornado threat. Routine monitoring recommended.":e<4?"Low-end risk. Keep an eye on forecast updates and radar trends.":e<6?"Moderate risk. Ingredients are present for isolated severe storms.":e<8?"Elevated risk. Organized severe storms capable of producing tornadoes are possible.":"High risk. Conditions favor strong tornado development. Review safety plans immediately."}static pseudoRandom(e,t,n){const a=43758.5453*Math.sin(12.9898*e+78.233*t+43758.5453*n);return a-Math.floor(a)}}function K(e){c(e,"svelte-1p9y649",".plugin-container.svelte-1p9y649.svelte-1p9y649{padding:16px;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;max-height:90vh;overflow-y:auto}.plugin-header.svelte-1p9y649.svelte-1p9y649{text-align:center;margin-bottom:20px;border-bottom:2px solid #e0e0e0;padding-bottom:10px}.plugin-header.svelte-1p9y649 h2.svelte-1p9y649{margin:0 0 5px 0;color:#2c3e50;font-size:1.4rem}.plugin-header.svelte-1p9y649 p.svelte-1p9y649{margin:0;color:#7f8c8d;font-size:0.9rem}.status.svelte-1p9y649.svelte-1p9y649{margin:0 0 12px 0;padding:8px 12px;border-radius:6px;background:#f1f2f6;color:#2f3542;font-size:0.9rem;transition:background 0.3s ease}.status--ready.svelte-1p9y649.svelte-1p9y649{background:#e8f9ef;color:#216c2a}.status--error.svelte-1p9y649.svelte-1p9y649{background:#fdecea;color:#b00020}.mode-toggle.svelte-1p9y649.svelte-1p9y649{display:grid;grid-template-columns:repeat(2, minmax(0, 1fr));gap:10px;margin:16px 0}.mode-toggle.svelte-1p9y649 button.svelte-1p9y649{border:none;border-radius:8px;padding:10px;font-weight:600;font-size:0.95rem;cursor:pointer;background:#ecf0f1;color:#2c3e50;transition:all 0.25s ease}.mode-toggle.svelte-1p9y649 button.svelte-1p9y649:hover{background:#dfe6e9}.mode-toggle.svelte-1p9y649 button.active.svelte-1p9y649{background:linear-gradient(135deg, #6c5ce7, #0984e3);color:white;box-shadow:0 6px 16px rgba(108, 92, 231, 0.25)}.controls.svelte-1p9y649.svelte-1p9y649{margin-bottom:20px}.control-hint.svelte-1p9y649.svelte-1p9y649{margin:0;font-size:0.8rem;color:#5f6d7a;background:#f2f4f6;padding:8px 10px;border-radius:6px}.control-group.svelte-1p9y649.svelte-1p9y649{margin-bottom:12px}.control-group.svelte-1p9y649 label.svelte-1p9y649,.control-label.svelte-1p9y649.svelte-1p9y649{display:block;font-weight:600;margin-bottom:4px;color:#34495e;font-size:0.85rem}.control-group.svelte-1p9y649 select.svelte-1p9y649,.control-group.svelte-1p9y649 input.svelte-1p9y649{width:100%;padding:6px 8px;border:1px solid #bdc3c7;border-radius:4px;font-size:0.85rem;background:white}.control-group.svelte-1p9y649 select.svelte-1p9y649:focus,.control-group.svelte-1p9y649 input.svelte-1p9y649:focus{outline:none;border-color:#3498db;box-shadow:0 0 0 2px rgba(52, 152, 219, 0.2)}.overlay-toggle.svelte-1p9y649.svelte-1p9y649{width:100%;padding:10px;background:linear-gradient(135deg, #3498db, #2980b9);color:white;border:none;border-radius:6px;font-weight:600;cursor:pointer;margin-top:10px;transition:all 0.3s ease}.overlay-toggle.svelte-1p9y649.svelte-1p9y649:hover{background:linear-gradient(135deg, #2980b9, #1f5f99);transform:translateY(-1px)}.overlay-toggle.svelte-1p9y649.svelte-1p9y649:disabled{background:#b2bec3;cursor:not-allowed;transform:none;box-shadow:none;opacity:0.8}.location-info.svelte-1p9y649.svelte-1p9y649{background:#ecf0f1;padding:8px 12px;border-radius:4px;margin-bottom:15px;font-size:0.85rem}.loading.svelte-1p9y649.svelte-1p9y649{text-align:center;padding:20px;color:#7f8c8d}.results.svelte-1p9y649.svelte-1p9y649{margin-bottom:20px}.result-card.svelte-1p9y649.svelte-1p9y649{background:#f8f9fa;border:1px solid #e9ecef;border-radius:8px;padding:16px;margin-bottom:12px}.result-card.svelte-1p9y649 h3.svelte-1p9y649{margin:0 0 12px 0;color:#2c3e50;font-size:1rem;border-bottom:1px solid #dee2e6;padding-bottom:6px}.main-stats.svelte-1p9y649.svelte-1p9y649{background:linear-gradient(135deg, #74b9ff, #0984e3);color:white;border:none}.main-stats.svelte-1p9y649 h3.svelte-1p9y649{color:white;border-bottom-color:rgba(255, 255, 255, 0.3)}.stat-grid.svelte-1p9y649.svelte-1p9y649{display:grid;grid-template-columns:1fr;gap:8px;margin-bottom:15px}.stat.svelte-1p9y649.svelte-1p9y649{display:flex;justify-content:space-between;align-items:center}.stat.svelte-1p9y649 .label.svelte-1p9y649{font-size:0.85rem;opacity:0.9}.stat.svelte-1p9y649 .value.svelte-1p9y649{font-weight:700;font-size:1.1rem}.risk-value.svelte-1p9y649.svelte-1p9y649{text-shadow:0 1px 2px rgba(0, 0, 0, 0.15)}.risk-summary.svelte-1p9y649.svelte-1p9y649{margin:0;font-size:0.9rem;line-height:1.4;background:rgba(255, 255, 255, 0.2);padding:10px;border-radius:6px}.progress-bar.svelte-1p9y649.svelte-1p9y649{width:100%;height:8px;background:rgba(255, 255, 255, 0.3);border-radius:4px;overflow:hidden}.progress-fill.svelte-1p9y649.svelte-1p9y649{height:100%;background:#00b894;border-radius:4px;transition:width 0.6s ease}.temp-stats.svelte-1p9y649.svelte-1p9y649{display:grid;grid-template-columns:repeat(3, 1fr);gap:12px;text-align:center}.temp-stats.svelte-1p9y649 div.svelte-1p9y649{background:white;padding:8px;border-radius:4px;font-size:0.85rem;font-weight:600}.tornado-ingredients.svelte-1p9y649.svelte-1p9y649{list-style:none;padding:0;margin:0 0 10px 0;display:grid;gap:6px}.tornado-ingredients.svelte-1p9y649 li.svelte-1p9y649{background:white;border-radius:6px;padding:8px 10px;font-size:0.85rem;display:flex;justify-content:space-between}.ingredients-note.svelte-1p9y649.svelte-1p9y649{margin:0;font-size:0.8rem;color:#57606f}.trend-chart.svelte-1p9y649.svelte-1p9y649{display:flex;align-items:flex-end;gap:4px;height:60px;padding:6px 4px 0 4px}.trend-chart.tornado.svelte-1p9y649.svelte-1p9y649{background:#f5f6fa;border-radius:6px;padding-bottom:6px}.trend-bar.svelte-1p9y649.svelte-1p9y649{flex:1;background:linear-gradient(to top, #74b9ff, #0984e3);border-radius:2px 2px 0 0;min-height:2px;transition:all 0.3s ease}.trend-bar.svelte-1p9y649.svelte-1p9y649:hover{background:linear-gradient(to top, #00b894, #00a085)}.chart-label.svelte-1p9y649.svelte-1p9y649{font-size:0.75rem;text-align:center;color:#7f8c8d;margin:5px 0 0 0}.instructions.svelte-1p9y649.svelte-1p9y649{background:#fff3cd;border:1px solid #ffeaa7;border-radius:6px;padding:16px}.instructions.svelte-1p9y649 h3.svelte-1p9y649{margin:0 0 10px 0;color:#856404;font-size:1rem}.instructions.svelte-1p9y649 ul.svelte-1p9y649{margin:0;padding-left:20px}.instructions.svelte-1p9y649 li.svelte-1p9y649{margin-bottom:6px;font-size:0.85rem;color:#856404;line-height:1.4}@media(max-width: 480px){.plugin-container.svelte-1p9y649.svelte-1p9y649{padding:12px}.temp-stats.svelte-1p9y649.svelte-1p9y649{grid-template-columns:1fr;gap:8px}.trend-chart.svelte-1p9y649.svelte-1p9y649{height:40px}}")}function J(e,t,n){const a=e.slice();return a[44]=t[n],a}function Y(e,t,n){const a=e.slice();return a[47]=t[n],a[49]=n,a}function Q(e,t,n){const a=e.slice();return a[50]=t[n][0],a[51]=t[n][1],a}function X(e){let t,n,a,o,r,l,c,u,f,k,w,_,T,$,D,C,R,I,G=e[14]?"Hide":"Show";return{c(){t=y("div"),n=y("label"),n.textContent="Forecast Window:",a=h(),o=y("select"),r=y("option"),r.textContent="Next 24 hours",l=y("option"),l.textContent="Next 36 hours",c=y("option"),c.textContent="Next 48 hours",u=y("option"),u.textContent="Next 72 hours",f=y("option"),f.textContent="Next 96 hours",k=h(),w=y("div"),w.innerHTML='<span class="control-label svelte-1p9y649">Model Ingredients:</span> <p class="control-hint svelte-1p9y649">Uses CAPE, wind shear, and helicity from forecast data.</p>',_=h(),T=y("button"),$=m(G),D=m(" Tornado Risk Overlay"),g(n,"for","forecast-window"),g(n,"class","svelte-1p9y649"),r.__value=24,b(r,r.__value),l.__value=36,b(l,l.__value),c.__value=48,b(c,c.__value),u.__value=72,b(u,u.__value),f.__value=96,b(f,f.__value),g(o,"id","forecast-window"),g(o,"class","svelte-1p9y649"),void 0===e[15]&&L(()=>e[30].call(o)),g(t,"class","control-group svelte-1p9y649"),g(w,"class","control-group svelte-1p9y649"),g(T,"class","overlay-toggle svelte-1p9y649"),g(T,"type","button"),T.disabled=C=!e[2]},m(s,p){d(s,t,p),i(t,n),i(t,a),i(t,o),i(o,r),i(o,l),i(o,c),i(o,u),i(o,f),M(o,e[15],!0),d(s,k,p),d(s,w,p),d(s,_,p),d(s,T,p),i(T,$),i(T,D),R||(I=[v(o,"change",e[30]),v(o,"change",e[20]),v(T,"click",e[22])],R=!0)},p(e,t){32768&t[0]&&M(o,e[15]),16384&t[0]&&G!==(G=e[14]?"Hide":"Show")&&x($,G),4&t[0]&&C!==(C=!e[2])&&(T.disabled=C)},d(e){e&&(p(t),p(k),p(w),p(_),p(T)),R=!1,s(I)}}}function Z(e){let t,n,a,o,r,l,c,k,w,_,T,$,D,C,R,I,G,F,S,P,H,z,E,A,N,q,U,W,B,V,K,J,Y,X,Z,te,ne,ae,oe,se=e[13]?"Hide":"Show",re=O(Object.entries(j)),le=[];for(let t=0;t<re.length;t+=1)le[t]=ee(Q(e,re,t));return{c(){t=y("div"),n=y("label"),n.textContent="Crop Type:",a=h(),o=y("select");for(let e=0;e<le.length;e+=1)le[e].c();r=h(),l=y("div"),c=y("label"),c.textContent="Base Temperature (¬∞C):",k=h(),w=y("input"),_=h(),T=y("div"),$=y("label"),$.textContent="Upper Threshold (¬∞C):",D=h(),C=y("input"),R=h(),I=y("div"),G=y("label"),G.textContent="Calculation Method:",F=h(),S=y("select"),P=y("option"),P.textContent="Simple Average",H=y("option"),H.textContent="Modified (No Negatives)",z=y("option"),z.textContent="Double Sine",E=h(),A=y("div"),N=y("label"),N.textContent="Time Period (days):",q=h(),U=y("select"),W=y("option"),W.textContent="Last 7 days",B=y("option"),B.textContent="Last 14 days",V=y("option"),V.textContent="Last 30 days",K=y("option"),K.textContent="Last 60 days",J=y("option"),J.textContent="Growing Season",Y=h(),X=y("button"),Z=m(se),te=m(" Heat Map"),g(n,"for","crop-select"),g(n,"class","svelte-1p9y649"),g(o,"id","crop-select"),g(o,"class","svelte-1p9y649"),void 0===e[0]&&L(()=>e[25].call(o)),g(t,"class","control-group svelte-1p9y649"),g(c,"for","base-temp"),g(c,"class","svelte-1p9y649"),g(w,"id","base-temp"),g(w,"type","number"),g(w,"min","0"),g(w,"max","25"),g(w,"step","0.5"),g(w,"class","svelte-1p9y649"),g(l,"class","control-group svelte-1p9y649"),g($,"for","upper-temp"),g($,"class","svelte-1p9y649"),g(C,"id","upper-temp"),g(C,"type","number"),g(C,"min","20"),g(C,"max","45"),g(C,"step","0.5"),g(C,"class","svelte-1p9y649"),g(T,"class","control-group svelte-1p9y649"),g(G,"for","method"),g(G,"class","svelte-1p9y649"),P.__value="simple",b(P,P.__value),H.__value="modified",b(H,H.__value),z.__value="double-sine",b(z,z.__value),g(S,"id","method"),g(S,"class","svelte-1p9y649"),void 0===e[8]&&L(()=>e[28].call(S)),g(I,"class","control-group svelte-1p9y649"),g(N,"for","period"),g(N,"class","svelte-1p9y649"),W.__value="7",b(W,W.__value),B.__value="14",b(B,B.__value),V.__value="30",b(V,V.__value),K.__value="60",b(K,K.__value),J.__value="90",b(J,J.__value),g(U,"id","period"),g(U,"class","svelte-1p9y649"),void 0===e[9]&&L(()=>e[29].call(U)),g(A,"class","control-group svelte-1p9y649"),g(X,"class","overlay-toggle svelte-1p9y649"),g(X,"type","button"),X.disabled=ne=!e[2]},m(s,p){d(s,t,p),i(t,n),i(t,a),i(t,o);for(let e=0;e<le.length;e+=1)le[e]&&le[e].m(o,null);M(o,e[0],!0),d(s,r,p),d(s,l,p),i(l,c),i(l,k),i(l,w),b(w,e[6]),d(s,_,p),d(s,T,p),i(T,$),i(T,D),i(T,C),b(C,e[7]),d(s,R,p),d(s,I,p),i(I,G),i(I,F),i(I,S),i(S,P),i(S,H),i(S,z),M(S,e[8],!0),d(s,E,p),d(s,A,p),i(A,N),i(A,q),i(A,U),i(U,W),i(U,B),i(U,V),i(U,K),i(U,J),M(U,e[9],!0),d(s,Y,p),d(s,X,p),i(X,Z),i(X,te),ae||(oe=[v(o,"change",e[25]),v(o,"change",e[19]),v(w,"input",e[26]),v(C,"input",e[27]),v(S,"change",e[28]),v(U,"change",e[29]),v(X,"click",e[22])],ae=!0)},p(e,t){if(0&t){let n;for(re=O(Object.entries(j)),n=0;n<re.length;n+=1){const a=Q(e,re,n);le[n]?le[n].p(a,t):(le[n]=ee(a),le[n].c(),le[n].m(o,null))}for(;n<le.length;n+=1)le[n].d(1);le.length=re.length}1&t[0]&&M(o,e[0]),64&t[0]&&f(w.value)!==e[6]&&b(w,e[6]),128&t[0]&&f(C.value)!==e[7]&&b(C,e[7]),256&t[0]&&M(S,e[8]),512&t[0]&&M(U,e[9]),8192&t[0]&&se!==(se=e[13]?"Hide":"Show")&&x(Z,se),4&t[0]&&ne!==(ne=!e[2])&&(X.disabled=ne)},d(e){e&&(p(t),p(r),p(l),p(_),p(T),p(R),p(I),p(E),p(A),p(Y),p(X)),u(le,e),ae=!1,s(oe)}}}function ee(e){let t,a,o,s,r=e[51].icon+"",l=e[51].name+"";return{c(){t=y("option"),a=m(r),o=h(),s=m(l),t.__value=e[50],b(t,t.__value)},m(e,n){d(e,t,n),i(t,a),i(t,o),i(t,s)},p:n,d(e){e&&p(t)}}}function te(e){let t,n,a,o,s,r,l,c=e[12].lat.toFixed(4)+"",u=e[12].lon.toFixed(4)+"";return{c(){t=y("div"),n=y("p"),a=y("strong"),a.textContent="Selected Location:",o=h(),s=m(c),r=m(", "),l=m(u),g(t,"class","location-info svelte-1p9y649")},m(e,c){d(e,t,c),i(t,n),i(n,a),i(n,o),i(n,s),i(n,r),i(n,l)},p(e,t){4096&t[0]&&c!==(c=e[12].lat.toFixed(4)+"")&&x(s,c),4096&t[0]&&u!==(u=e[12].lon.toFixed(4)+"")&&x(l,u)},d(e){e&&p(t)}}}function ne(e){let t,n,a,o,s="heat-units"===e[5]?"Calculating heat units‚Ä¶":"Analyzing tornado forecast‚Ä¶";return{c(){t=y("div"),n=y("p"),a=m("üîÑ "),o=m(s),g(t,"class","loading svelte-1p9y649")},m(e,s){d(e,t,s),i(t,n),i(n,a),i(n,o)},p(e,t){32&t[0]&&s!==(s="heat-units"===e[5]?"Calculating heat units‚Ä¶":"Analyzing tornado forecast‚Ä¶")&&x(o,s)},d(e){e&&p(t)}}}function ae(e){let t,n,a,o,s,r,l,c,v,f,b,M,w,_,T,$,D,C,R,I,G,F,S,L,P,H,z,E,A,N,q,U,W,B,V,K,J,Q,X,Z,ee,te,ne,ae,le,ie,ce,de,pe,ue,ye,me,he,ve,ge,fe,xe,be,ke,Me,we,_e,Te,$e,De,Ce,Re,Ie=e[1].gdd.toFixed(1)+"",Ge=j[e[0]].name+"",Fe=j[e[0]].gddRequired+"",Se=e[16].toFixed(1)+"",Le=e[1].temperature.min.toFixed(1)+"",Pe=e[1].temperature.max.toFixed(1)+"",He=e[1].temperature.avg.toFixed(1)+"";function ze(e,t){return e[17]>0&&e[17]!==1/0?se:e[16]>=100?oe:void 0}let Ee=ze(e),Ae=Ee&&Ee(e),Oe=O(e[1].dailyGdd.slice(-14)),Ne=[];for(let t=0;t<Oe.length;t+=1)Ne[t]=re(Y(e,Oe,t));return{c(){t=y("div"),n=y("div"),a=y("h3"),a.textContent="Heat Unit Summary",o=h(),s=y("div"),r=y("div"),l=y("span"),l.textContent="Accumulated GDD:",c=h(),v=y("span"),f=m(Ie),b=h(),M=y("div"),w=y("span"),_=m("Required for "),T=m(Ge),$=m(":"),D=h(),C=y("span"),R=m(Fe),I=h(),G=y("div"),F=y("span"),F.textContent="Completion:",S=h(),L=y("span"),P=m(Se),H=m("%"),z=h(),E=y("div"),A=y("div"),N=h(),q=y("div"),U=y("h3"),U.textContent="Crop Development",W=h(),B=y("p"),V=y("strong"),V.textContent="Current Stage:",K=h(),J=m(e[18]),Q=h(),Ae&&Ae.c(),X=h(),Z=y("div"),ee=y("h3"),te=m("Temperature Summary ("),ne=m(e[9]),ae=m(" days)"),le=h(),ie=y("div"),ce=y("div"),de=m("Min: "),pe=m(Le),ue=m("¬∞C"),ye=h(),me=y("div"),he=m("Max: "),ve=m(Pe),ge=m("¬∞C"),fe=h(),xe=y("div"),be=m("Avg: "),ke=m(He),Me=m("¬∞C"),we=h(),_e=y("div"),Te=y("h3"),Te.textContent="Recent GDD Trend",$e=h(),De=y("div");for(let e=0;e<Ne.length;e+=1)Ne[e].c();Ce=h(),Re=y("p"),Re.textContent="Last 14 days daily GDD accumulation",g(a,"class","svelte-1p9y649"),g(l,"class","label svelte-1p9y649"),g(v,"class","value svelte-1p9y649"),g(r,"class","stat svelte-1p9y649"),g(w,"class","label svelte-1p9y649"),g(C,"class","value svelte-1p9y649"),g(M,"class","stat svelte-1p9y649"),g(F,"class","label svelte-1p9y649"),g(L,"class","value svelte-1p9y649"),g(G,"class","stat svelte-1p9y649"),g(s,"class","stat-grid svelte-1p9y649"),g(A,"class","progress-fill svelte-1p9y649"),k(A,"width",e[16]+"%"),g(E,"class","progress-bar svelte-1p9y649"),g(n,"class","result-card main-stats svelte-1p9y649"),g(U,"class","svelte-1p9y649"),g(q,"class","result-card svelte-1p9y649"),g(ee,"class","svelte-1p9y649"),g(ce,"class","svelte-1p9y649"),g(me,"class","svelte-1p9y649"),g(xe,"class","svelte-1p9y649"),g(ie,"class","temp-stats svelte-1p9y649"),g(Z,"class","result-card svelte-1p9y649"),g(Te,"class","svelte-1p9y649"),g(De,"class","trend-chart svelte-1p9y649"),g(Re,"class","chart-label svelte-1p9y649"),g(_e,"class","result-card svelte-1p9y649"),g(t,"class","results svelte-1p9y649")},m(e,p){d(e,t,p),i(t,n),i(n,a),i(n,o),i(n,s),i(s,r),i(r,l),i(r,c),i(r,v),i(v,f),i(s,b),i(s,M),i(M,w),i(w,_),i(w,T),i(w,$),i(M,D),i(M,C),i(C,R),i(s,I),i(s,G),i(G,F),i(G,S),i(G,L),i(L,P),i(L,H),i(n,z),i(n,E),i(E,A),i(t,N),i(t,q),i(q,U),i(q,W),i(q,B),i(B,V),i(B,K),i(B,J),i(q,Q),Ae&&Ae.m(q,null),i(t,X),i(t,Z),i(Z,ee),i(ee,te),i(ee,ne),i(ee,ae),i(Z,le),i(Z,ie),i(ie,ce),i(ce,de),i(ce,pe),i(ce,ue),i(ie,ye),i(ie,me),i(me,he),i(me,ve),i(me,ge),i(ie,fe),i(ie,xe),i(xe,be),i(xe,ke),i(xe,Me),i(t,we),i(t,_e),i(_e,Te),i(_e,$e),i(_e,De);for(let e=0;e<Ne.length;e+=1)Ne[e]&&Ne[e].m(De,null);i(_e,Ce),i(_e,Re)},p(e,t){if(2&t[0]&&Ie!==(Ie=e[1].gdd.toFixed(1)+"")&&x(f,Ie),1&t[0]&&Ge!==(Ge=j[e[0]].name+"")&&x(T,Ge),1&t[0]&&Fe!==(Fe=j[e[0]].gddRequired+"")&&x(R,Fe),65536&t[0]&&Se!==(Se=e[16].toFixed(1)+"")&&x(P,Se),65536&t[0]&&k(A,"width",e[16]+"%"),262144&t[0]&&x(J,e[18]),Ee===(Ee=ze(e))&&Ae?Ae.p(e,t):(Ae&&Ae.d(1),Ae=Ee&&Ee(e),Ae&&(Ae.c(),Ae.m(q,null))),512&t[0]&&x(ne,e[9]),2&t[0]&&Le!==(Le=e[1].temperature.min.toFixed(1)+"")&&x(pe,Le),2&t[0]&&Pe!==(Pe=e[1].temperature.max.toFixed(1)+"")&&x(ve,Pe),2&t[0]&&He!==(He=e[1].temperature.avg.toFixed(1)+"")&&x(ke,He),2&t[0]){let n;for(Oe=O(e[1].dailyGdd.slice(-14)),n=0;n<Oe.length;n+=1){const a=Y(e,Oe,n);Ne[n]?Ne[n].p(a,t):(Ne[n]=re(a),Ne[n].c(),Ne[n].m(De,null))}for(;n<Ne.length;n+=1)Ne[n].d(1);Ne.length=Oe.length}},d(e){e&&p(t),Ae&&Ae.d(),u(Ne,e)}}}function oe(e){let t;return{c(){t=y("p"),t.innerHTML="<strong>Status:</strong> ‚úÖ Ready for harvest"},m(e,n){d(e,t,n)},p:n,d(e){e&&p(t)}}}function se(e){let t,n,a,o,s;return{c(){t=y("p"),n=y("strong"),n.textContent="Est. Days to Maturity:",a=h(),o=m(e[17]),s=m(" days")},m(e,r){d(e,t,r),i(t,n),i(t,a),i(t,o),i(t,s)},p(e,t){131072&t[0]&&x(o,e[17])},d(e){e&&p(t)}}}function re(e){let t,n;return{c(){t=y("div"),g(t,"class","trend-bar svelte-1p9y649"),k(t,"height",Math.max(2,e[47]/Math.max(...e[1].dailyGdd)*60)+"px"),g(t,"title",n="Day "+(e[49]+1)+": "+e[47].toFixed(1)+" GDD")},m(e,n){d(e,t,n)},p(e,a){2&a[0]&&k(t,"height",Math.max(2,e[47]/Math.max(...e[1].dailyGdd)*60)+"px"),2&a[0]&&n!==(n="Day "+(e[49]+1)+": "+e[47].toFixed(1)+" GDD")&&g(t,"title",n)},d(e){e&&p(t)}}}function le(e){let t,n,a,o,s,r,l,c,v,f,b,M,w,_,T,$,D,C,R,I,G,F,S,L,P,H,z,E,A,N,q,U,W,j,B,V,K,Y,Q,X,Z,ee,te,ne,ae,oe,se,re,le,ce,pe,ue,ye,me,he,ve,ge,fe,xe,be,ke,Me,we=e[11].riskIndex.toFixed(1)+"",_e=Math.round(100*e[11].probability)+"",Te=e[11].forecastHours+"",$e=e[11].summary+"",De=e[11].parameters.cape+"",Ce=e[11].parameters.shear+"",Re=e[11].parameters.helicity+"",Ie=e[11].timeline.length+"",Ge=O(e[11].timeline),Fe=[];for(let t=0;t<Ge.length;t+=1)Fe[t]=ie(J(e,Ge,t));return{c(){t=y("div"),n=y("div"),a=y("h3"),a.textContent="Tornado Risk Outlook",o=h(),s=y("div"),r=y("div"),l=y("span"),l.textContent="Risk Index (0-10):",c=h(),v=y("span"),f=m(we),b=h(),M=y("div"),w=y("span"),w.textContent="Probability:",_=h(),T=y("span"),$=m(_e),D=m("%"),C=h(),R=y("div"),I=y("span"),I.textContent="Forecast Window:",G=h(),F=y("span"),S=m("Next "),L=m(Te),P=m("h"),H=h(),z=y("p"),E=m($e),A=h(),N=y("div"),q=y("h3"),q.textContent="Key Ingredients",U=h(),W=y("ul"),j=y("li"),B=y("strong"),B.textContent="CAPE:",V=h(),K=m(De),Y=m(" J/kg"),Q=h(),X=y("li"),Z=y("strong"),Z.textContent="0-6 km Shear:",ee=h(),te=m(Ce),ne=m(" m/s"),ae=h(),oe=y("li"),se=y("strong"),se.textContent="Storm-Relative Helicity:",re=h(),le=m(Re),ce=m(" m¬≤/s¬≤"),pe=h(),ue=y("p"),ue.textContent="Higher values of these ingredients support rotating updrafts that can produce tornadoes.",ye=h(),me=y("div"),he=y("h3"),he.textContent="Risk Trend",ve=h(),ge=y("div");for(let e=0;e<Fe.length;e+=1)Fe[e].c();fe=h(),xe=y("p"),be=m("Risk index every 3 hours ("),ke=m(Ie),Me=m(" points)"),g(a,"class","svelte-1p9y649"),g(l,"class","label svelte-1p9y649"),g(v,"class","value risk-value svelte-1p9y649"),k(v,"color",de(e[11].riskIndex)),g(r,"class","stat svelte-1p9y649"),g(w,"class","label svelte-1p9y649"),g(T,"class","value svelte-1p9y649"),g(M,"class","stat svelte-1p9y649"),g(I,"class","label svelte-1p9y649"),g(F,"class","value svelte-1p9y649"),g(R,"class","stat svelte-1p9y649"),g(s,"class","stat-grid svelte-1p9y649"),g(z,"class","risk-summary svelte-1p9y649"),g(n,"class","result-card main-stats svelte-1p9y649"),g(q,"class","svelte-1p9y649"),g(j,"class","svelte-1p9y649"),g(X,"class","svelte-1p9y649"),g(oe,"class","svelte-1p9y649"),g(W,"class","tornado-ingredients svelte-1p9y649"),g(ue,"class","ingredients-note svelte-1p9y649"),g(N,"class","result-card svelte-1p9y649"),g(he,"class","svelte-1p9y649"),g(ge,"class","trend-chart tornado svelte-1p9y649"),g(xe,"class","chart-label svelte-1p9y649"),g(me,"class","result-card svelte-1p9y649"),g(t,"class","results svelte-1p9y649")},m(e,p){d(e,t,p),i(t,n),i(n,a),i(n,o),i(n,s),i(s,r),i(r,l),i(r,c),i(r,v),i(v,f),i(s,b),i(s,M),i(M,w),i(M,_),i(M,T),i(T,$),i(T,D),i(s,C),i(s,R),i(R,I),i(R,G),i(R,F),i(F,S),i(F,L),i(F,P),i(n,H),i(n,z),i(z,E),i(t,A),i(t,N),i(N,q),i(N,U),i(N,W),i(W,j),i(j,B),i(j,V),i(j,K),i(j,Y),i(W,Q),i(W,X),i(X,Z),i(X,ee),i(X,te),i(X,ne),i(W,ae),i(W,oe),i(oe,se),i(oe,re),i(oe,le),i(oe,ce),i(N,pe),i(N,ue),i(t,ye),i(t,me),i(me,he),i(me,ve),i(me,ge);for(let e=0;e<Fe.length;e+=1)Fe[e]&&Fe[e].m(ge,null);i(me,fe),i(me,xe),i(xe,be),i(xe,ke),i(xe,Me)},p(e,t){if(2048&t[0]&&we!==(we=e[11].riskIndex.toFixed(1)+"")&&x(f,we),2048&t[0]&&k(v,"color",de(e[11].riskIndex)),2048&t[0]&&_e!==(_e=Math.round(100*e[11].probability)+"")&&x($,_e),2048&t[0]&&Te!==(Te=e[11].forecastHours+"")&&x(L,Te),2048&t[0]&&$e!==($e=e[11].summary+"")&&x(E,$e),2048&t[0]&&De!==(De=e[11].parameters.cape+"")&&x(K,De),2048&t[0]&&Ce!==(Ce=e[11].parameters.shear+"")&&x(te,Ce),2048&t[0]&&Re!==(Re=e[11].parameters.helicity+"")&&x(le,Re),2048&t[0]){let n;for(Ge=O(e[11].timeline),n=0;n<Ge.length;n+=1){const a=J(e,Ge,n);Fe[n]?Fe[n].p(a,t):(Fe[n]=ie(a),Fe[n].c(),Fe[n].m(ge,null))}for(;n<Fe.length;n+=1)Fe[n].d(1);Fe.length=Ge.length}2048&t[0]&&Ie!==(Ie=e[11].timeline.length+"")&&x(ke,Ie)},d(e){e&&p(t),u(Fe,e)}}}function ie(e){let t,n;return{c(){t=y("div"),g(t,"class","trend-bar svelte-1p9y649"),g(t,"title",n=`T+${e[44].hourOffset}h ¬∑ Risk ${e[44].riskIndex.toFixed(1)} ¬∑ ${Math.round(100*e[44].probability)}% chance`),k(t,"height",`${Math.max(4,e[44].riskIndex/10*70)}px`),k(t,"background",de(e[44].riskIndex))},m(e,n){d(e,t,n)},p(e,a){2048&a[0]&&n!==(n=`T+${e[44].hourOffset}h ¬∑ Risk ${e[44].riskIndex.toFixed(1)} ¬∑ ${Math.round(100*e[44].probability)}% chance`)&&g(t,"title",n),2048&a[0]&&k(t,"height",`${Math.max(4,e[44].riskIndex/10*70)}px`),2048&a[0]&&k(t,"background",de(e[44].riskIndex))},d(e){e&&p(t)}}}function ce(e){let t,a,o,r,l,c,u,f,b,k,M,w,T,$,D,C,R,I,G,F,S=(e[4]?e[4]:e[3])+"";function L(e,t){return"heat-units"===e[5]?Z:X}let P=L(e),H=P(e),z=e[12]&&te(e),E=e[10]&&ne(e),A="heat-units"===e[5]&&e[1]&&ae(e),O="tornado"===e[5]&&e[11]&&le(e);return{c(){t=y("section"),a=y("header"),a.innerHTML='<h2 class="svelte-1p9y649">üå°Ô∏è Agricultural Heat Units</h2> <p class="svelte-1p9y649">Growing Degree Days &amp; Severe Weather Toolkit</p>',o=h(),r=y("p"),l=m(S),c=h(),u=y("div"),f=y("button"),f.textContent="üå± Heat Units",b=h(),k=y("button"),k.textContent="üå™Ô∏è Tornado Outlook",M=h(),w=y("div"),H.c(),T=h(),z&&z.c(),$=h(),E&&E.c(),D=h(),A&&A.c(),C=h(),O&&O.c(),R=h(),I=y("div"),I.innerHTML='<h3 class="svelte-1p9y649">How to Use</h3> <ul class="svelte-1p9y649"><li class="svelte-1p9y649">üéØ Click anywhere on the map to analyze the selected location</li> <li class="svelte-1p9y649">üåæ Use Heat Units mode to pick a crop and adjust temperature thresholds</li> <li class="svelte-1p9y649">üå™Ô∏è Switch to Tornado Outlook mode to evaluate forecast-based risk ingredients</li> <li class="svelte-1p9y649">üó∫Ô∏è Toggle the overlay to visualize either GDD or tornado risk across the map</li> <li class="svelte-1p9y649">üìà Review trend cards to monitor crop progress or tornado risk timing</li></ul>',g(a,"class","plugin-header svelte-1p9y649"),g(r,"class","status svelte-1p9y649"),_(r,"status--ready",e[2]),_(r,"status--error",!!e[4]),g(f,"type","button"),g(f,"class","svelte-1p9y649"),_(f,"active","heat-units"===e[5]),g(k,"type","button"),g(k,"class","svelte-1p9y649"),_(k,"active","tornado"===e[5]),g(u,"class","mode-toggle svelte-1p9y649"),g(w,"class","controls svelte-1p9y649"),g(I,"class","instructions svelte-1p9y649"),g(t,"class","plugin-container svelte-1p9y649")},m(n,s){d(n,t,s),i(t,a),i(t,o),i(t,r),i(r,l),i(t,c),i(t,u),i(u,f),i(u,b),i(u,k),i(t,M),i(t,w),H.m(w,null),i(t,T),z&&z.m(t,null),i(t,$),E&&E.m(t,null),i(t,D),A&&A.m(t,null),i(t,C),O&&O.m(t,null),i(t,R),i(t,I),G||(F=[v(f,"click",e[23]),v(k,"click",e[24])],G=!0)},p(e,n){24&n[0]&&S!==(S=(e[4]?e[4]:e[3])+"")&&x(l,S),4&n[0]&&_(r,"status--ready",e[2]),16&n[0]&&_(r,"status--error",!!e[4]),32&n[0]&&_(f,"active","heat-units"===e[5]),32&n[0]&&_(k,"active","tornado"===e[5]),P===(P=L(e))&&H?H.p(e,n):(H.d(1),H=P(e),H&&(H.c(),H.m(w,null))),e[12]?z?z.p(e,n):(z=te(e),z.c(),z.m(t,$)):z&&(z.d(1),z=null),e[10]?E?E.p(e,n):(E=ne(e),E.c(),E.m(t,D)):E&&(E.d(1),E=null),"heat-units"===e[5]&&e[1]?A?A.p(e,n):(A=ae(e),A.c(),A.m(t,C)):A&&(A.d(1),A=null),"tornado"===e[5]&&e[11]?O?O.p(e,n):(O=le(e),O.c(),O.m(t,R)):O&&(O.d(1),O=null)},i:n,o:n,d(e){e&&p(t),H.d(),z&&z.d(),E&&E.d(),A&&A.d(),O&&O.d(),G=!1,s(F)}}}function de(e){const t=Math.max(0,Math.min(1,e/10));return`hsl(${120-120*t}, 85%, ${40+10*t}%)`}function pe(e,t,n){let a,o,s,r,l,i=!1,c="Initializing‚Ä¶",d="",p=null,u=0,y="heat-units",m="corn",h=j[m].baseTemp,v=j[m].upperTemp,g="modified",x=30,b=!1,k=null,M=null,_=null,T=null,$=null,C=48;var R;function I(e){const{lat:t,lng:a}=e.latlng;n(12,_={lat:t,lon:a}),"heat-units"===y?F(t,a):S(t,a)}function G(e){e.lat&&e.lon&&(n(12,_={lat:e.lat,lon:e.lon}),"heat-units"===y?F(e.lat,e.lon):S(e.lat,e.lon))}async function F(e,t){n(10,b=!0);try{n(1,k=await V.getTemperatureData(e,t,x)),n(11,M=null)}catch(e){console.error("Failed to calculate heat units:",e)}finally{n(10,b=!1)}}async function S(e,t){n(10,b=!0);try{n(11,M=await V.getTornadoRiskData(e,t,C))}catch(e){console.error("Failed to calculate tornado risk:",e)}finally{n(10,b=!1)}}function L(e){y!==e&&(n(5,y=e),"heat-units"===y?($&&(r.removeLayer($),n(14,$=null)),_&&F(_.lat,_.lon)):(T&&(r.removeLayer(T),n(13,T=null)),_&&S(_.lat,_.lon)))}R=()=>{const e=()=>{const e=window.W;return!!e&&(function(e){n(2,i=!0),n(3,c="Connected to the Windy map."),n(4,d=""),r=e.map,e.picker,e.store,l=e.broadcast,p&&(clearInterval(p),p=null),r&&r.on("click",I),l&&l.on("pickerOpened",G)}(e),!0)};e()||(n(3,c="Waiting for the Windy map to initialize‚Ä¶"),p=setInterval(()=>{u+=1,e()||u>=40&&(n(4,d="Unable to connect to the Windy API. Try reloading the plugin."),n(3,c="Windy API not available."),p&&(clearInterval(p),p=null))},500))},D().$$.on_mount.push(R),function(e){D().$$.on_destroy.push(e)}(()=>{r&&r.off("click",I),l&&l.off("pickerOpened",G),p&&(clearInterval(p),p=null),T&&r.removeLayer(T),$&&r.removeLayer($)});return e.$$.update=()=>{3&e.$$.dirty[0]&&n(18,a=k?B.getCropStage(k.gdd,j[m].gddRequired):""),3&e.$$.dirty[0]&&n(17,o=k?B.estimateDaysToMaturity(k.gdd,j[m].gddRequired,k.dailyGdd.slice(-7).reduce((e,t)=>e+t,0)/7):0),3&e.$$.dirty[0]&&n(16,s=k?Math.min(100,k.gdd/j[m].gddRequired*100):0)},[m,k,i,c,d,y,h,v,g,x,b,M,_,T,$,C,s,o,a,function(){const e=j[m];n(6,h=e.baseTemp),n(7,v=e.upperTemp),_&&"heat-units"===y&&F(_.lat,_.lon)},function(e){const t=Number(e.target.value);n(15,C=t),_&&"tornado"===y&&S(_.lat,_.lon)},L,function(){r&&("heat-units"===y?T?(r.removeLayer(T),n(13,T=null)):async function(){const e=r.getBounds(),t={crop:m,baseTemp:h,upperTemp:v,timePeriod:x};try{const a=await V.generateHeatMapData(e,t),o=window.L;if(!o)return void console.warn("Leaflet API not available to render heat map overlay.");const s=o.layerGroup();a.data.forEach(e=>{const t=function(e){const t=Math.max(0,Math.min(1,e));return`hsl(${200-160*t}, 85%, ${40+20*t}%)`}(e.intensity),n=o.circleMarker([e.lat,e.lon],{radius:6,color:t,fillColor:t,fillOpacity:.55,weight:0});n.bindPopup(`GDD: ${e.gdd.toFixed(0)}\nIntensity: ${(100*e.intensity).toFixed(0)}%`),s.addLayer(n)}),s.addTo(r),n(13,T=s)}catch(e){console.error("Failed to create heat map:",e)}}():$?(r.removeLayer($),n(14,$=null)):async function(){const e=r.getBounds();try{const t=await V.generateTornadoRiskOverlay(e,C),a=window.L;if(!a)return void console.warn("Leaflet API not available to render tornado overlay.");const o=a.layerGroup();t.points.forEach(e=>{const t=de(e.riskIndex),n=a.circleMarker([e.lat,e.lon],{radius:Math.max(4,e.riskIndex/10*9),color:t,fillColor:t,fillOpacity:.6,weight:1});n.bindPopup(`Risk index: ${e.riskIndex.toFixed(1)} / 10\nProbability: ${(100*e.probability).toFixed(0)}%`),o.addLayer(n)}),o.addTo(r),n(14,$=o)}catch(e){console.error("Failed to create tornado overlay:",e)}}())},()=>L("heat-units"),()=>L("tornado"),function(){m=w(this),n(0,m)},function(){h=f(this.value),n(6,h)},function(){v=f(this.value),n(7,v)},function(){g=w(this),n(8,g)},function(){x=w(this),n(9,x)},function(){C=w(this),n(15,C)}]}var ue=Object.freeze({__proto__:null,default:class extends W{constructor(e){super(),U(this,e,pe,ce,l,{},K,[-1,-1])}}});export{e as config,t as default};
